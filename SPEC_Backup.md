# SPEC

## 目標
建立可追溯、可重算、可稽核的計算流程，確保「每一個數字都知道從哪裡來」。

## 技術棧
- 流程: Excel → SQLite → 重算 → Streamlit
- 語言: Python

## 範圍
- In: Excel 匯入、資料庫分層設計、計算引擎、手動輸入介面、結果對照與驗證、多語系支援
- Out: 雲端部署、多使用者權限系統、排程/監控、企業級報表平台整合

## 關鍵原則
1) 欄位與輸出先維持 Excel 對應
2) 唯一鍵使用 serialnumber
3) 計算邏輯以 Excel 現有公式邏輯為準
4) 同時保留 Excel 邏輯結果與 Priority/門檻模型結果
5) 手動輸入需提供 UI，且保留從 Excel 匯入的功能
6) 版本先不保留，但需預留可版本化的彈性
7) UI 以多分頁逐一呈現，涵蓋所有內容

---

## 資料層命名
- Raw Data
- Manual Data
- Extend Data

---

## 資料匯入定義（最新版，覆蓋先前）
- 來源樣本檔案（Field_Mapping 基礎）：C:\\Users\\hsi67063\\Documents\\BE File\\Q3FY26(WK3)完成要求_260109_Update_ rev2  0110.xlsx
- 欄位翻譯優先順序：Field_Mapping 對照表 -> 自動翻譯
- 欄位名稱重複處理：追加 -1, -2, -3...
- 空白列／標題列：略過

### WIP_Raw_data
- 來源：Sheet1
- 欄位名稱：第 1 列（若非英文先翻譯）
- 範圍：A 欄至最後欄位，所有資料列完整匯入

### Mapping_Table
- 來源：Build Plan
- 欄位範圍：A~C
- 欄位名稱：第 4 列
- 資料列：第 5 列起，A/B/C 任一欄有值即保留；空白列略過

### Build+Plan
- 來源：Build Plan
- 欄位範圍：D 欄至最後欄位
- 欄位名稱：第 4 列
- 資料列：第 5 列起，D~最後任一欄有值即保留
- 排除規則：小計／合計列（SUM、FYxx Σ 類型）不保留
- 區塊規則：表格分區塊時需判斷並略過區塊內標題列

### WIP_Raw_DATE
- 來源：仕掛りリスト
- 欄位名稱：第 1 列（日文翻譯成英文）
- 範圍：整張表格，A 欄起始，所有資料列完整匯入

### Complete_WIP
- 來源：完成数
- 欄位名稱：第 1 列（日文翻譯成英文）
- 範圍：整張表格，從頭到最後一列

### Extra_Completed_WIP
- 來源：0時以降の完成数
- 欄位名稱：第 1 列（日文翻譯成英文）
- 範圍：整張表格，從頭到最後一列

### Shipping_Plan
- 來源：ShippingPlan
- 欄位名稱：第 1 列 + 第 2 列（合併欄位表頭，拼接後作為欄位名）
- 欄位翻譯：日文翻譯成英文
- 資料列：第 3 列起，從頭到最後一列

### Field_Mapping
- 來源：上述樣本檔案（掃描各工作表欄位名建立對照）
- 用途：提供日文/非英文欄位名稱的英文化對照
- 規則：對照不到時採自動翻譯

---

## UI 需求（目前版本）
- 可指定匯入檔案路徑並記憶
- 可執行匯入
- 可查詢所有匯入資料（全表搜尋）

---

## 多語系規範
- 語言：繁體中文 / 英文 / 日文
- 切換方式：下拉式選單（使用者手動選擇）
